<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:ScoutCode.ViewModels"
             xmlns:models="clr-namespace:ScoutCode.Models"
             x:Class="ScoutCode.Views.HomePage"
             x:DataType="vm:HomeViewModel"
             Title="{Binding Title}"
             Shell.NavBarIsVisible="False"
             BackgroundColor="{StaticResource ScoutBg}">

    <Grid RowDefinitions="Auto,*">

        <!-- ══════════ HEADER: Montañas + Título ══════════ -->
        <Grid Grid.Row="0"
              HeightRequest="150"
              BackgroundColor="{StaticResource ScoutNavy}">
            <Grid.Clip>
                <RectangleGeometry Rect="0,0,1000,150" />
            </Grid.Clip>

            <!-- Montaña Ámbar (atrás) -->
            <Polygon Points="-60,150 60,18 220,150"
                     Fill="{StaticResource ScoutOrange}"
                     Opacity="0.85"
                     HorizontalOptions="Start"
                     VerticalOptions="End" />

            <!-- Montaña Teal (medio) -->
            <Polygon Points="-30,150 100,28 260,150"
                     Fill="{StaticResource ScoutGreen}"
                     Opacity="0.9"
                     HorizontalOptions="Start"
                     VerticalOptions="End" />

            <!-- Montaña Azul oscuro (frente) -->
            <Polygon Points="0,150 140,38 310,150"
                     Fill="#1B2A4A"
                     HorizontalOptions="Start"
                     VerticalOptions="End" />

            <!-- Título -->
            <VerticalStackLayout HorizontalOptions="End"
                                 VerticalOptions="Center"
                                 Padding="0,0,28,0"
                                 Spacing="0">
                <Label Text="Scout"
                       FontSize="34"
                       FontFamily="OpenSansSemibold"
                       FontAttributes="Bold"
                       TextColor="White"
                       HorizontalTextAlignment="End"
                       LineHeight="1.0" />
                <Label Text="Code"
                       FontSize="34"
                       FontFamily="OpenSansSemibold"
                       FontAttributes="Bold"
                       TextColor="{StaticResource AccentAmber}"
                       HorizontalTextAlignment="End"
                       Margin="0,-4,0,0"
                       LineHeight="1.0" />
            </VerticalStackLayout>
        </Grid>

        <!-- ══════════ CONTENIDO ══════════ -->
        <ScrollView Grid.Row="1">
            <VerticalStackLayout Padding="20,22,20,28" Spacing="14">

                <Label Text="Selecciona una clave"
                       FontSize="13"
                       FontFamily="OpenSansSemibold"
                       TextTransform="Uppercase"
                       CharacterSpacing="1.5"
                       Margin="2,0,0,2"
                       TextColor="{StaticResource Gray400}" />

                <CollectionView ItemsSource="{Binding Ciphers}"
                                SelectionMode="None">
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="models:CipherDefinition">
                            <Border Stroke="{StaticResource ScoutCardBorder}"
                                    StrokeShape="RoundRectangle 14"
                                    StrokeThickness="0"
                                    Padding="14,14,12,14"
                                    Margin="0,0,0,10"
                                    BackgroundColor="{StaticResource ScoutCardBg}">
                                <Border.Shadow>
                                    <Shadow Brush="#0C1E293B"
                                            Offset="0,3"
                                            Radius="12"
                                            Opacity="0.35" />
                                </Border.Shadow>
                                <Border.GestureRecognizers>
                                    <TapGestureRecognizer
                                        Command="{Binding Source={RelativeSource AncestorType={x:Type vm:HomeViewModel}}, Path=NavigateToCipherCommand}"
                                        CommandParameter="{Binding .}" />
                                </Border.GestureRecognizers>

                                <Grid ColumnDefinitions="42,*,20" ColumnSpacing="14">
                                    <!-- Badge con inicial -->
                                    <Border Grid.Column="0"
                                            BackgroundColor="{StaticResource AccentIndigo}"
                                            StrokeShape="RoundRectangle 11"
                                            Stroke="Transparent"
                                            StrokeThickness="0"
                                            HeightRequest="42"
                                            WidthRequest="42"
                                            HorizontalOptions="Center"
                                            VerticalOptions="Center">
                                        <Label Text="{Binding Icon}"
                                               FontSize="15"
                                               FontFamily="OpenSansSemibold"
                                               FontAttributes="Bold"
                                               TextColor="White"
                                               HorizontalTextAlignment="Center"
                                               VerticalTextAlignment="Center" />
                                    </Border>

                                    <!-- Info -->
                                    <VerticalStackLayout Grid.Column="1"
                                                         VerticalOptions="Center"
                                                         Spacing="2">
                                        <Label Text="{Binding Name}"
                                               FontSize="15"
                                               FontFamily="OpenSansSemibold"
                                               TextColor="{StaticResource Gray900}" />
                                        <Label Text="{Binding Description}"
                                               FontSize="11.5"
                                               TextColor="{StaticResource Gray400}"
                                               LineBreakMode="TailTruncation"
                                               MaxLines="1" />
                                    </VerticalStackLayout>

                                    <!-- Chevron -->
                                    <Label Grid.Column="2"
                                           Text="&#x203A;"
                                           FontSize="22"
                                           TextColor="{StaticResource Gray300}"
                                           VerticalTextAlignment="Center"
                                           HorizontalTextAlignment="Center" />
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>

                <Label Text="v1.0  ·  100% Offline  ·  Hecho para Scouts"
                       FontSize="11"
                       FontFamily="OpenSansRegular"
                       HorizontalTextAlignment="Center"
                       TextColor="{StaticResource Gray300}"
                       Margin="0,6,0,0" />

            </VerticalStackLayout>
        </ScrollView>

    </Grid>
</ContentPage>
